## Taxes and Tariffs Reproducibility Package 

This folder contains the reproducibility package for the Research Paper "Shifting Revenue Strategy: The Inverse Relationship
Between Consumption Tax and Tariff Revenue in Developed and Developing Countries" by Dylan Thomas, Umar Bilgrammi, and Kathryn Sarrge

### Computational Requirements
- Stata (code was last run with version 16)
- The code was last run on a **Windows 10 computer with 32.0 GB of RAM**

## Table of Contents
1. [Introduction](#introduction)  
2. [Data Description and Accessing](#data-description-and-accessing)  
3. [Datasets and Do Files](#datasets-and-do-files)
4. [Merging Data](#merging-data)
5. [Data Outputs](#data-outputs)
6. [Code for Reproducibility](#code-for-reproducibility)  
7. [Outputs](#outputs)

## Introduction

The Reproducibility package will describe our project files, data, variables, the terminology used in the report, and outputs in great detail. It is designed to organize and keep all files in one place for ease of reproducibility. The table of contents provides a guide to break the project into sections, although we recommend viewing each section in order. 

TO do
1. create a list of files mentioned at the bottom
2. add summary statistics
3. fill in the two-sample t-tests
4. add more description if nessecarry



## Data Description and Accessing 

List of all variables 
- Consumption (tax)
  -  A variable used in the [consumption tax data](https://github.com/ecn310/course-project-taxes-tariffs/tree/main/Reproducibility_Package/Data_Files/consumptiontaxreproducible.dta) which represents the percent of revenue that consumption tax generates for a country within a given year. The variable represents the tax side of the project. This variable is also observed in the final data and is used to generate figures seen in the output section. A popular consumption tax referenced in the paper is VAT (Value Added Tax). [(Section #7)](#outputs)
- International (Tax)
  - A variable used in the [international data](https://github.com/ecn310/course-project-taxes-tariffs/tree/main/Reproducibility_Package/Data_Files/internationaltax.dta) describes the percentage of revenue generated by international tax for a given country within a given year. It represents the tariffs side of the project. The variable is also observed in the final data and is used to generate figures seen in the output section. [(Section #7)](#outputs)
- GDP (Per Capita)
  - This variable is observed in the [GDPdataset.xlsx](https://github.com/ecn310/course-project-taxes-tariffs/tree/main/Reproducibility_Package/raw_data/GDPdataset.xlsx). It is not a primary variable. This variable is used to sort countries into developing and developed based on a cutoff of $12,000. The variable appears in the final data due to this cutoff used to sort countries but is not used in any correlation tests.

Each of these variables comes from its own unique data found on the World Integrated Trade Solution (WITS) wesbite. Follow the directions below to access the data. 

IMPORTANT: To download the raw data, use the links below to access the datasets on the WITS website. Then, click the light grey button that has an arrow pointing downwards in the top right of the table. This will create an Excel file download. Download the Excel file and use the import feature in stata to load the data into stata. Do not import any variables as strings or change any row names to strings. This is important for reshaping the data for later. 

Links to download the data set are found here: 

Note: when saving these datasets save them to their exact excel file names linked [here](https://github.com/ecn310/course-project-taxes-tariffs/tree/main/Reproducibility_Package/raw_data)
Alternatively, you can change the file name but that means when running do files you will have to put the file names in place of the file names we have added. 

- Consumption Tax Variable 
  - [Taxes on Goods and Services](https://wits.worldbank.org/CountryProfile/en/Country/BY-COUNTRY/StartYear/1988/EndYear/2022/Indicator/GC-TAX-GSRV-VA-ZS)
 
- International Tax Variable
  - [Taxes on international trade](https://wits.worldbank.org/CountryProfile/en/Country/BY-COUNTRY/StartYear/1988/EndYear/2022/Indicator/GC-TAX-INTT-RV-ZS)
 
- GDP Per Capita Variable
  - [GDP per capita](https://wits.worldbank.org/CountryProfile/en/Country/BY-COUNTRY/StartYear/1988/EndYear/2022/Indicator/NY-GDP-PCAP-PP-CD)

Alternatively, you can download our raw data Excel sheets here: 

Each of the variables mentioned above have their own data set found in the raw_data folder linked here: [raw_data](https://github.com/ecn310/course-project-taxes-tariffs/tree/main/Reproducibility_Package/raw_data) they are labeled:
- [internationaldataset.xlsx]([url](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/raw_data/internationaldataset.xlsx))
- [consumptiontaxdataset.xlsx]([url](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/raw_data/consumptiondataset.xlsx))
- [GDPdataset.xlsx]([url](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/raw_data/GDPdataset.xlsx))


## Datasets and Do Files

Now that raw data has been downloaded and accessed. The data must be reshaped from wide to long. You will notice that all of the years are imported from 1988-2022, creating a large table of values. The end goal is to essentially reshape the data from a wide table into a list of each country with each year and its corresponding data entry. This allows for easier merging of data. To do so, each data file must be changed from its raw data state into the final data state as seen in our Data_Files folder linked here: [Data_Files](https://github.com/ecn310/course-project-taxes-tariffs/tree/main/Reproducibility_Package/Data_Files)

Using the raw data Excel files, which are loaded into stata through the import feature with no strings, follow these steps. 

__International Tax Dataset__ 
  - Open the international tax dataset through the import excel sheet feature in stata. Do not check any boxes and click continue. 
    - The do file to replicate the international tax datasheet is found here: [internationaltaxnew.do](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Do_Files/internationtaltaxnew.do)
      - Running this do file will reshape the data from wide to long. More details can be found inside the do-file.
  - Use the raw data from above loaded into stata and run the data to get the final dataset.
    -  The final dataset titled International Tax Dataset is found [here](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Data_Files/internationaltax.dta)
     - Run the internationaltaxnew do-file listed right above to create a new data set that matches the final international tax dataset. 

NOTE: When running the do file, be sure to change the user name. Since the user running this reproducibility package will not have the same running file path it is necessary to change the user name in the file path. For example, taken from the international tax do file "import excel "C:\Users\changenamehere\OneDrive - Syracuse University\Documents\GitHub\course-project-taxes-tariffs\Reproducibility_Package\Excel_Files\internationaltaxdatasheet.xlsx", sheet("Country-Timeseries") Your file path may look different depending on whether you saved the Excel sheet in the one-drive directory or not. Be aware of this and change the file directory as needed. 

__Consumption Tax Dataset__
  - Open the consumption tax dataset through the import excel sheet feature in stata. Do not check any boxes and click continue. 
    -  The do file to replicate the final data is [consumptiontax.do](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Do_Files/consumptiontax.do)
  - Use the raw data from above loaded into stata and run the data to get the final dataset.
    -  The final dataset for this variable named consumption tax dataset is found [here ](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Data_Files/consumptiontaxreproducible.dta)
  -  Running the do file on the data will give a data set which matches this final data set above. 

__GDP Per Capita Dataset__
  - Open the GDPdataset.xlsx through the import excel feature in stata. Do not check any boxes and continue. 
    - The do file to replicate the final dataset is [gdpdata.do](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Do_Files/gdpdata.do)
  - Use the raw data from above loaded into stata and run the data to get the dataset.
    - The final data set for GDP per capita dataset is found [here ](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Data_Files/gdpreproducible.dta)
  - Running the do file on the Excel file sheet will give the same final dataset as the one linked above

With all of the datasets now reshaped from wide to long, it is time to merge the datasets to generate figures, and summary statistics, run correlation tests, and test the null hypothesis. 

## Merging Data

Due to the size of the datasets, two different merging steps will take place. First, the [consumptiontaxreproducible.dta](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Data_Files/consumptiontaxreproducible.dta) will be merged with [internationaltax.dta](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Data_Files/internationaltax.dta). This will combine our two main variables. Then, GDP will be merged with the data to split countries into developed and developing, allowing for correlation tests to be carried out.  

To merge the data follow these steps
- __Step 1__
  - use the [do file](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Do_Files/mergeddata.do) to merge consumption tax with international tax
  - This should give you the file: [merged.dta](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Data_Files/merged.dta)
  - Save this file as merged.dta and clear stata if not already done.

- __Step 2__
  - using merged.dta follow this [do file ](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Do_Files/sortedultimatemerge.do)
  - This will give you the final data set titled, sortedultimatemerge.dta. The dataset is linked [here](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Data_Files/sortedultimatemerge.dta)

NOTE: Running the do file for sortedultimatemerge splits countries into developed and developing. Within the dataset, countries are assigned an ID to represent which country is developed and developing. An ID of 1 means the country is developed. An ID of 2 means the country is developing. You will also notice we ran the code drop if international < -5. This is because there is a bad data entry in the dataset regarding China's consumption tax for the year 2005. This data entry is removed to prevent skewing of the graph and summary statistics. 

Data has now been successfully merged and transformed into the final dataset. The data can now be used to run tests, generate figures, and test the null hypothesis. 

## Data Outputs
The provided do files provide code and reproducibility for all the tables and figures in the paper.

To run the correlation tests and two-sample t-tests, make sure to use the sortedultimatemerge.dta

- __Correlation tests__
- We are running a P-test in order to determine if the variables consumption and international have a positive or negative relationship. Furthermore, given the correlation are testing with P-values to see if the correlation between the variables is statistically significant, giving us reason to reject our [null hypothesis](https://github.com/ecn310/course-project-taxes-tariffs/discussions/26). Statistically significant means the relationship between the two variables is not due to random chance, implying there is concrete evidence and theory behind the patterns observed. 
  - First, open the data set. Click the browse data option in stata's menu bar to make sure the right data set has been opened. The correct dataset is sortedultimatemerge.dta.
    - The correlations test do file is found in the [mergeddata.do](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Do_Files/mergeddata.do) file
    - Run the pwcorr international consumption, sig and look for the bottom-most number on the left side. This is P-value. The number above it is the correlation coefficient. 
  - Specifically, the line pwcorr international consumption, sig generates a correlation coefficient of -0.3255 and a P-value of 0.000.
    - This means that there is a moderate inverse relationship between the consumption and international variables. Furthermore, a P-value of 0.000 is statistically significant giving us reason to reject our null hypothesis.


__Two-Sample T-Tests__
- The Two-Sample T-Test do file is found in the [T-Tests.do](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Do_Files/T-Tests.do)
- A table of the results is found [here](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/research_outputs/T-Tests)
- Interpretation of the results is in found in the [LaTeX report](https://www.overleaf.com/project/66fdd3a10a7eff5a6a8c7ef7)
- Basic introductory summary of the tests: XXXXXXXXXX

## Outputs

In addition, we also generated four figures used in our final report. A table showing the dataset, do file, and output png is below:

| Exhibit | Input dataset | Program | Outputs |
|---------|---------------|---------|---------|
| Figure 1 | [sortedultimatemerge.dta](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Data_Files/sortedultimatemerge.dta) | [scatterplotconvsint.do](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Do_Files/scatterplotconsvsint.do) | [Scatterplotintvscons.png](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/research_outputs/Scatterplotintvscons.png) |
| Figure 2 | [sortedultimatemerge.dta](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Data_Files/sortedultimatemerge.dta) | [twowayhistintcons.do ](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Do_Files/twowayhistintcons.do)| [twowayhistintcons.png](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/research_outputs/twowayhistintcons.png) |
| Figure 3 | [sortedultimatemerge.dta](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Data_Files/sortedultimatemerge.dta)| [twowaydevelopinghistintcons.do](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Do_Files/twowaydevelopinghistintcons.do)| [twowayhistdevelopingintcons.png](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/research_outputs/twowayhistdevelopingintcons.png) |
| Figure 4 | [sortedultimatemerge.dta](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Data_Files/sortedultimatemerge.dta) | [twowaydevelopedhistintcons.do](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/Do_Files/twowaydevelopedhistintcons.do) | [twowayhistdevelopedintcons.png](https://github.com/ecn310/course-project-taxes-tariffs/blob/main/Reproducibility_Package/research_outputs/twowayhistdevelopedintcons.png) |
